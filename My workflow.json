{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "dada61ab-b968-4f3d-84c1-d89d73a0497b",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        768,
        0
      ],
      "id": "845eb71f-14bb-402a-b779-87b2d47bcd86",
      "name": "Webhook",
      "webhookId": "dada61ab-b968-4f3d-84c1-d89d73a0497b"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.User_Request }}",
        "options": {
          "systemMessage": "# Identity\nYou are a helpful customer support agent in a telecommunications company.\n\n# Tools\nYou have access to a tool that retrieves information from a vector database about billings, customer information, network status, tickets, and a general knowledge base.\n\n# Guidelines\n- Always query the appropriate table in the vector database before answering.\n- For network issues, first use the \"network_status\" table to find data about the customerâ€™s location.\n- Only if no data is returned from the database should you ask for clarification.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        992,
        0
      ],
      "id": "ab349ff8-3409-4e38-955f-577e7ef8b452",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "1",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        992,
        208
      ],
      "id": "bb38a105-8c15-4e1c-8eff-2a0db70ff0ae",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "model": "qwen/qwen3-coder",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        864,
        208
      ],
      "id": "a45b979e-6b78-448d-9b96-755e48a71b64",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "Od2uyUY6uBLTrS0v",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [
        1296,
        -16
      ],
      "id": "c4a28e0e-20ac-41eb-a065-7d350082da95",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "fileSelector": "=/home/node/.n8n-files/files/*",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1.1,
      "position": [
        0,
        0
      ],
      "id": "04e72b6f-5356-4ff6-bca4-3015162837be",
      "name": "Read/Write Files from Disk"
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        2128,
        -144
      ],
      "id": "ce1f0640-f92d-42f1-ac68-fcc7c20ba3fc",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "model": "qwen3-embedding:8b"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
      "typeVersion": 1,
      "position": [
        464,
        448
      ],
      "id": "41e5127e-0a4c-4368-a11c-d3142f5cc9a0",
      "name": "Embeddings Ollama",
      "credentials": {
        "ollamaApi": {
          "id": "N2qFk7YnyMoyaZD4",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this tool to search the company knowledge base for FAQs, policies, troubleshooting guides, and general support information. Use it when the user asks about company services, procedures, billing explanations, technical issues, or general inquiries that require documented information.\n",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        208,
        0
      ],
      "id": "f3128a99-4da6-485f-a32a-8b09c3665bf2",
      "name": "vector store",
      "credentials": {
        "supabaseApi": {
          "id": "vymOy6EUH45nZ0Ug",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "get billing information in supabase using the customer's 'customer_id'",
        "operation": "get",
        "tableId": "billing",
        "filters": {
          "conditions": [
            {
              "keyName": "customer_id",
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions1_Value', `The numeric ID of the customer (e.g., 1001). Do not provide strings or UUIDs.`, 'string') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1440,
        208
      ],
      "id": "d54e1ab6-e513-4f27-ae8c-9512a9290021",
      "name": "billings",
      "credentials": {
        "supabaseApi": {
          "id": "vymOy6EUH45nZ0Ug",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "get customer account information using the customer's 'customer_id'",
        "operation": "get",
        "tableId": "customers",
        "filters": {
          "conditions": [
            {
              "keyName": "customer_id",
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Value', `The numeric ID of the customer (e.g., 1001). Do not provide strings or UUIDs.`, 'string') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1536,
        208
      ],
      "id": "c0c79df1-eb7b-48b9-a312-0dc84efea5ee",
      "name": "customers",
      "credentials": {
        "supabaseApi": {
          "id": "vymOy6EUH45nZ0Ug",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Retrieve ticket information from the database using either a ticket_id or a customer_id. \n\nUse this tool when the user asks about ticket status, existing support requests, issue progress, or support history. \n\nThis tool returns real-time ticket data from the system.\n",
        "operation": "get",
        "tableId": "tickets",
        "filters": {
          "conditions": [
            {
              "keyName": "ticket_id",
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Field_Value', ``, 'string') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1632,
        208
      ],
      "id": "c4174055-8efe-4c94-bf93-ea10f5041bf2",
      "name": "tickets",
      "credentials": {
        "supabaseApi": {
          "id": "vymOy6EUH45nZ0Ug",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "get network status from a location using the information provided by the user like their location id, city, and area code.",
        "operation": "getAll",
        "tableId": "network_status"
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1728,
        208
      ],
      "id": "0d62ae78-ba3c-4c51-8bab-547d1bb29f69",
      "name": "network status",
      "credentials": {
        "supabaseApi": {
          "id": "vymOy6EUH45nZ0Ug",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "contains about frequently asked questions by customers",
        "tableName": {
          "__rl": true,
          "value": "general knowledge",
          "mode": "list",
          "cachedResultName": "general knowledge"
        },
        "topK": 0,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        1136,
        224
      ],
      "id": "89b248c8-b635-42f2-b9e7-41b1e56f9c2b",
      "name": "knowledge base",
      "credentials": {
        "supabaseApi": {
          "id": "vymOy6EUH45nZ0Ug",
          "name": "Supabase account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk": {
      "main": [
        []
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        []
      ]
    },
    "Embeddings Ollama": {
      "ai_embedding": [
        [
          {
            "node": "vector store",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "knowledge base",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "billings": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "customers": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "tickets": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "network status": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "knowledge base": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "binaryMode": "separate",
    "availableInMCP": false
  },
  "versionId": "96ae23dd-cf17-409b-8067-5aa9bf2aee02",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "00e5ff37b51a60791146217869936d1273dbfd4aee48938d13aa7629f378217a"
  },
  "id": "fCnPBx30ZNMlr3F2T9lKm",
  "tags": []
}